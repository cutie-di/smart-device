function isEscEvent(e){return 27===e.keyCode||"Escape"===e.key||"Esc"===e.key}function isEnterEvent(e){return 13===e.keyCode||"Enter"===e.key}function isTabPressed(e){return 9===e.keyCode||"Tab"===e.key}const pageBody=document.querySelector(".page-body");pageBody.classList.remove("nojs");const accordionTriggers=document.querySelectorAll(".navigation__trigger"),accordionTriggerDisable=e=>{e.disabled=!0,setTimeout((()=>{e.disabled=!1}),500)},setHeightOnTransitionEnd=e=>{e.addEventListener("transitionend",(()=>{"0px"!==e.style.height&&(e.style.height="auto")}))},accordionOpen=(e,t)=>{"0px"!==t.style.height&&"0px"!==window.getComputedStyle(t).height||(e.classList.add("navigation__trigger--active"),e.setAttribute("aria-expanded","true"),t.setAttribute("aria-hidden","false"),t.classList.add("navigation__inner-content--active"),t.style.height=`${t.scrollHeight}px`)},accordionClose=(e,t)=>{"0px"!==t.style.height&&"0px"!==window.getComputedStyle(t).height&&(e.classList.remove("navigation__trigger--active"),e.setAttribute("aria-expanded","false"),t.setAttribute("aria-hidden","true"),t.style.height=`${t.scrollHeight}px`,setTimeout((()=>{t.style.height="0"}),0),setTimeout((()=>{t.classList.remove("navigation__inner-content--active")}),700))},accordionToggle=e=>{const t=e,o=e.closest(".navigation__accordion-item").querySelector(".navigation__inner-content");setHeightOnTransitionEnd(o),t.classList.contains("navigation__trigger--active")?(accordionClose(t,o),accordionTriggerDisable(t)):(accordionOpen(t,o),accordionTriggerDisable(t))},onButtonClick=()=>{accordionTriggers.forEach((e=>{e.addEventListener("click",(e=>{const t=e.currentTarget;accordionToggle(t)}))}))};function createPhoneMask(e){let t=0;const o="+7(___) ___-__-__",n=o.replace(/\D/g,"");let r=e.target.value.replace(/\D/g,"");n.length>=r.length&&(r=n),e.target.value=o.replace(/./g,(e=>/[_\d]/.test(e)&&t<r.length?r.charAt(t++):t>=r.length?"":e))}function checkPhoneFocus(e){e.addEventListener("focus",(t=>{0===e.value.length&&(t.target.value="+7")})),e.addEventListener("blur",(t=>{"+7"===e.value&&(t.target.value="")}))}accordionTriggers.forEach((e=>{e.addEventListener("click",(e=>{const t=e.currentTarget;accordionToggle(t)}))}));const forms=document.querySelectorAll("[name=feedback-form]"),phoneInputs=document.querySelectorAll('input[type="tel"]'),phoneRegex=/^((\+7|7|8)+([0-9]){10})$/,MIN_NUMBERS_LENGTH=16,errorMessage="Пожалуйста, проверьте правильность введенных данных";function checkPhoneField(e,t){const o=t.value.replace(/\D/g,""),n=o.length;0===n?t.setCustomValidity("Пожалуйста, введите номер"):n<16&&!e.test(o)?t.setCustomValidity(errorMessage):e.test(o)?t.setCustomValidity(""):t.setCustomValidity(errorMessage),t.reportValidity()}phoneInputs.forEach((e=>{checkPhoneFocus(e),e.addEventListener("keypress",(e=>{/\d/.test(e.key)||e.preventDefault()})),e.addEventListener("input",createPhoneMask),e.addEventListener("input",(e=>{checkPhoneField(phoneRegex,e.target)}))})),forms.forEach((e=>{const t=e.querySelector('input[type="text"]'),o=e.querySelector('input[type="tel"]'),n=e.querySelector("textarea");o.removeAttribute("pattern");let r="",c="",a="";const s=()=>{try{return r=localStorage.getItem("userName"),c=localStorage.getItem("userPhone"),a=localStorage.getItem("userFeedback"),!0}catch(e){return!1}},l=s();s(),r&&(t.value=r),c&&(o.value=c),a&&(n.value=a),e.addEventListener("submit",(()=>{l&&(localStorage.setItem("userName",t.value),localStorage.setItem("userPhone",o.value),localStorage.setItem("userFeedback",n.value))}))}));const modal=document.querySelector(".modal"),overlay=modal.querySelector(".overlay"),openButton=document.querySelector(".main-nav__button a"),closeButton=modal.querySelector('button[type="button"]'),popupNameInput=modal.querySelector('input[type="text"]');function closePopup(){modal.classList.remove("modal--show"),overlay.classList.remove("overlay--show"),document.body.classList.remove("page-no-scroll"),openButton.focus()}function closeOnButton(e){e.preventDefault(),closePopup(),closeButton.removeEventListener("click",closeOnButton)}function closeOnEnter(e){isEnterEvent(e)&&(closePopup(),closeButton.removeEventListener("keydown",closeOnButton))}function closeOnOverlay(e){e.preventDefault(),closePopup(),overlay.removeEventListener("click",closeOnOverlay)}function closeOnEsc(e){isEscEvent(e)&&(e.preventDefault(),closePopup(),document.removeEventListener("keydown",closeOnEsc))}function openPopup(){openButton.addEventListener("click",(e=>{e.preventDefault(),modal.classList.add("modal--show"),overlay.classList.add("overlay--show"),document.body.classList.add("page-no-scroll"),popupNameInput.focus(),closeButton.addEventListener("click",closeOnButton),closeButton.addEventListener("keydown",closeOnEnter),overlay.addEventListener("click",closeOnOverlay),document.addEventListener("keydown",closeOnEsc)}))}function trapFocus(e){const t=modal.querySelectorAll("input,button,textarea"),o=t[0],n=t[t.length-1];e.addEventListener("keydown",(e=>{isTabPressed&&(e.shiftKey&&"Tab"===e.key?document.activeElement===o&&(n.focus(),e.preventDefault()):document.activeElement===n&&(o.focus(),e.preventDefault()))}))}function scrollToElement(e){e.scrollIntoView({behavior:"smooth",block:"start"})}function smoothAnchorScroll(){document.querySelectorAll('a[href^="#"]:not(a[href="#"]').forEach((e=>{e.addEventListener("click",(t=>{t.preventDefault();const o=e.getAttribute("href");scrollToElement(document.querySelector(o))}))}))}openPopup(),trapFocus(modal),smoothAnchorScroll();